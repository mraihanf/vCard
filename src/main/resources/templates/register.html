<!DOCTYPE html>
<html lang="en" xmlns="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
        integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/css/bootstrap.min.css"
        integrity="sha512-SbiR/eusphKoMVVXysTKG/7VseWii+Y3FdHrt0EpKgpToZeemhqHeZeLWLhJutz/2ut2Vw1uQEj2MbRF+TVBUA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <title>B-Universe</title>
    <link rel="shortcut icon" sizes="16x16" th:href="@{/Images/BTV.ico}" />

</head>

<body th:style="'background-image:url('+@{/Images/back.png}+');background-size:cover;'">
    <div class="container">
        <div class="row" style="justify-content: center;">
            <img th:src="@{/Images/B_UNIVERSE_LOGO_COLOR.png}" style="height: 150px; width: auto;">
        </div>
        <!-- <div class="imageprofile mx-auto d-block"
            style="justify-content: center; height: 200px; width: 200px; box-shadow: 0 0 50px #ccc; border-radius: 50%; ">
            <img src="Screenshot 2023-03-07 at 15.11.01.png"
                style="height: 100%; width: 100%; object-fit:cover; overflow: hidden; border-radius: 50%; ">
        </div> -->
        <!-- http://wa.me/+628â€¦ -->
        <div class="row">
            <form id="formperson" action="#" enctype="multipart/form-data">
                <div class="row">
                    <input name="files" class="form-control" type="file" id="filep" accept="image/*" />
                </div>
                <input type="text" th:value="${session.username}" id="usernameee" hidden />
                <label class="mt-3" style="color: white;">Nama Lengkap</label>
                <input type="text" id="isinama" class="form-control mt-1" />
                <label class="mt-3" style="color: white;">Isi Divisi</label>
                <input type="text" id="isidivisi" class="form-control mt-1" />
                <label class="mt-3" style="color: white;">No Whatsapps</label>
                <input type="text" id="isino" class="form-control mt-1" />
                <label class="mt-3" style="color: white;">Email</label>
                <input type="text" id="isiemail" class="form-control mt-1" />
            </form>
            <a class="btn btn-primary mt-5" type="button" onclick="senddata()">Simpan</a>
            <a class="btn btn-outline-warning mt-3" type="button" onclick="generateQR()">Generate QR</a>
        </div>

    </div>
</body>
<div class="modal fade bd-example-modal-lg" data-backdrop="static" data-keyboard="false" tabindex="-1"
    id="modalLoading">
    <div class="modal-dialog modal-sm">
        <div class="modal-content" style="width: 48px">
            <span class="fa fa-spinner fa-spin fa-3x"></span>
        </div>
    </div>
</div>

</html>


<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/js/bootstrap.min.js"
    integrity="sha512-1/RvZTcCDEUjY/CypiMz+iqqtaoQfAITmNSJY17Myp4Ms5mdxPS5UV7iOfdZoxcGhzFbOm6sntTKJppjvuhg4g=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js"
    integrity="sha512-aVKKRRi/Q/YV+4mjoKBsE4x3H+BkegoM/em46NNlCqNTmUYADjBbeNefNxYV7giUp0VxICtqdrbqU7iVaeZNXA=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.2.0/axios.min.js"
    integrity="sha512-OdkysyYNjK4CZHgB+dkw9xQp66hZ9TLqmS2vXaBrftfyJeduVhyy1cOfoxiKdi4/bfgpco6REu6Rb+V2oVIRWg=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script th:inline="javascript">
    /*<![CDATA[*/
    $(document).ready(function () {
        getdata()
    });

    function getdata(username) {
        var usm = document.getElementById("usernameee").value;
        $.get(`/findusername?username=${usm}`, function (res) {
            var per = res.data;
            $("#isinama").val(per.nama);
            $("#isidivisi").val(per.divisi);
            $("#isino").val(per.no_wa);
            $("#isiemail").val(per.email);
            // $("#mailing").attr("href", "mailto:" + `${per.email}` + "");
            // $("#wa").attr("href", "http://wa.me/" + `${per.no_wa}` + "");
        })
    }

    function senddata() {
        // var inputFile = document.getElementsById("filep");
        // console.log(inputFile.length);
        var uri = `/InputPerson?nama=${$("#isinama").val()}&nowa=${$("#isino").val()}&email=${$("#isiemail").val()}&divisi=${$("#isidivisi").val()}`;
        var bodyFormData = new FormData();
        var inputFile = document.getElementsByName("files");
        list = [];
        for (var i = 0; i < inputFile.length; i++) {
            var a = inputFile[i].files[0];
            list.push(a);
        }
        list.forEach(video => {
            bodyFormData.append("files", video);
            bodyFormData.append("files", list);
        });
        $.ajax({
            url: uri,
            method: "post",
            data: bodyFormData,
            headers: { "Content-Type": "multipart/form-data" },
            success: function () {
                
            }
        });
        // axios({
        //     method: "post",
        //     url: uri,
        //     data: bodyFormData,
        //     headers: { "Content-Type": "multipart/form-data" },

        // })
        //     .then(function (response) {
        //         Swal.fire({
        //             position: "center",
        //             icon: response.data.icon,
        //             title: response.data.message,
        //             showConfirmButton: false,
        //             timer: 1500,
        //         }).then((result) => {
        //             $("#modalLoading").modal("show");
        //             location.reload();
        //         });
        //     })
        //     .catch(function (obj) {
        //         Swal.fire({
        //             position: "center",
        //             icon: obj.response.data.icon,
        //             title: obj.response.data.message,
        //             showConfirmButton: false,
        //             timer: 1500,
        //         }).then((result) => {
        //             $("#modalLoading").modal("show");
        //             location.reload();
        //         });
        //     });;
        console.log(uri);
        // location.reload();
    }

    function generateQR() {
        var usme = document.getElementById("usernameee").value;
        // $.ajax({
        //     url: `/qrcode?link=139.255.52.68:8110/Person/${usme}`,
        //     method: "get",
        //     success: function () {
        //         // location.reload();
        //     }
        // });
        window.open("http://139.255.52.68:8110/qrcode?link=http://139.255.52.68:8110/Person/" + `${usme}` + "", "_blank")
    }


    /*]]>*/
</script>